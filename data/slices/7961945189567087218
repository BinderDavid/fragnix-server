{"sliceID":7961945189567087218,"uses":[{"reference":{"otherSlice":8017952720790218162},"usedName":{"constructorName":{"identifier":"SRequest"},"constructorTypeName":{"identifier":"SRequest"}},"qualification":null},{"reference":{"otherSlice":292801634566711306},"usedName":{"valueName":{"identifier":"ask"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"valueName":{"identifier":"liftIO"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"otherSlice":7987649984260342197},"usedName":{"valueName":{"identifier":"toChunks"}},"qualification":"L"},{"reference":{"otherSlice":2150836866812832620},"usedName":{"valueName":{"identifier":"requestBody"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef"}},"qualification":null},{"reference":{"otherSlice":4791260247128078865},"usedName":{"valueName":{"identifier":"empty"}},"qualification":"S"},{"reference":{"otherSlice":1795490339591616421},"usedName":{"valueName":{"identifier":"addCookiesToRequest"}},"qualification":null},{"reference":{"builtinModule":"GHC.Err"},"usedName":{"valueName":{"identifier":"error"}},"qualification":null},{"reference":{"otherSlice":1101192067246769824},"usedName":{"constructorName":{"identifier":"ResponseReceived"},"constructorTypeName":{"identifier":"ResponseReceived"}},"qualification":null},{"reference":{"otherSlice":2320217419932718576},"usedName":{"valueName":{"identifier":"runResponse"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":4877449830135502942},"usedName":{"valueName":{"identifier":"extractSetCookieFromSResponse"}},"qualification":null},{"reference":{"otherSlice":8017952720790218162},"usedName":{"typeName":{"identifier":"SRequest"}},"qualification":null},{"reference":{"otherSlice":6144584388836266359},"usedName":{"typeName":{"identifier":"Session"}},"qualification":null},{"reference":{"otherSlice":8946881164643755763},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null}],"fragment":["srequest :: SRequest -> Session SResponse","srequest (SRequest req bod)\n  = do app <- ask\n       refChunks <- liftIO $ newIORef $ L.toChunks bod\n       let req'\n             = req{requestBody =\n                     atomicModifyIORef refChunks $\n                       \\ bss ->\n                         case bss of\n                             [] -> ([], S.empty)\n                             x : y -> (y, x)}\n       req'' <- addCookiesToRequest req'\n       response <- liftIO $\n                     do ref <- newIORef $ error \"runResponse gave no result\"\n                        ResponseReceived <- app req'' (runResponse ref)\n                        readIORef ref\n       extractSetCookieFromSResponse response"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}