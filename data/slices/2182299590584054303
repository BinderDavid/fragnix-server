{"sliceID":2182299590584054303,"uses":[{"reference":{"otherSlice":1179971249929502811},"usedName":{"constructorName":{"identifier":"AuthSettings"},"constructorTypeName":{"identifier":"AuthSettings"}},"qualification":null},{"reference":{"otherSlice":1179971249929502811},"usedName":{"valueName":{"identifier":"authIsProtected"}},"qualification":null},{"reference":{"otherSlice":1179971249929502811},"usedName":{"valueName":{"identifier":"authOnNoAuth"}},"qualification":null},{"reference":{"otherSlice":1179971249929502811},"usedName":{"valueName":{"identifier":"authRealm"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"lookup"}},"qualification":null},{"reference":{"otherSlice":2325900752127330681},"usedName":{"valueName":{"identifier":"hAuthorization"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":2150836866812832620},"usedName":{"valueName":{"identifier":"requestHeaders"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"otherSlice":4867542540894059283},"usedName":{"valueName":{"identifier":"extractBasicAuth"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":2150836866812832620},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null},{"reference":{"otherSlice":5464375576982375319},"usedName":{"typeName":{"identifier":"CheckCreds"}},"qualification":null},{"reference":{"otherSlice":1179971249929502811},"usedName":{"typeName":{"identifier":"AuthSettings"}},"qualification":null},{"reference":{"otherSlice":8780573258186764165},"usedName":{"typeName":{"identifier":"Middleware"}},"qualification":null}],"fragment":["basicAuth' :: (Request -> CheckCreds) -> AuthSettings -> Middleware","basicAuth' checkCreds AuthSettings{..} app req sendResponse\n  = do isProtected <- authIsProtected req\n       allowed <- if isProtected then check else return True\n       if allowed then app req sendResponse else\n         authOnNoAuth authRealm req sendResponse\n  where check\n          = case\n              (lookup hAuthorization $ requestHeaders req) >>= extractBasicAuth\n              of\n                Nothing -> return False\n                Just (username, password) -> checkCreds req username password"],"instances":[],"language":{"extensions":["OverloadedStrings","RecordWildCards","TupleSections","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}