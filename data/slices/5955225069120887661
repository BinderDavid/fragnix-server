{"sliceID":5955225069120887661,"uses":[{"reference":{"otherSlice":4461705763959597941},"usedName":{"valueName":{"identifier":"runSTArray"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":409732285050159535},"usedName":{"valueName":{"identifier":"newArray"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"mapM_"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":5017290188364594010},"usedName":{"valueName":{"identifier":"writeArray"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":8460257586132860418},"usedName":{"typeName":{"identifier":"Header"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"otherSlice":8999779525047250338},"usedName":{"typeName":{"identifier":"HeaderName"}},"qualification":null},{"reference":{"otherSlice":7539027878723779009},"usedName":{"typeName":{"identifier":"IndexedHeader"}},"qualification":null}],"fragment":["traverseHeader ::\n               [Header] -> Int -> (HeaderName -> Int) -> IndexedHeader","traverseHeader hdr maxidx getIndex\n  = runSTArray $\n      do arr <- newArray (0, maxidx) Nothing\n         mapM_ (insert arr) hdr\n         return arr\n  where insert arr (key, val)\n          | idx == (-1) = return ()\n          | otherwise = writeArray arr idx (Just val)\n          where idx = getIndex key"],"instances":[],"language":{"extensions":["OverloadedStrings","FlexibleContexts","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}