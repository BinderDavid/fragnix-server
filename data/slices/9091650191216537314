{"sliceID":9091650191216537314,"uses":[{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"otherSlice":4942888801223460576},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":"S"},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":8984783929342293342},"usedName":{"typeName":{"identifier":"Builder"}},"qualification":null},{"reference":{"otherSlice":5831756764704217508},"usedName":{"valueName":{"identifier":"mallocByteString"}},"qualification":"S"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>="}},"qualification":null},{"reference":{"otherSlice":2981234607007717022},"usedName":{"valueName":{"identifier":"runBuilder"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.ForeignPtr"},"usedName":{"valueName":{"identifier":"unsafeForeignPtrToPtr"}},"qualification":"Unsafe"},{"reference":{"otherSlice":7564022038032245664},"usedName":{"constructorName":{"identifier":"Done"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$!"}},"qualification":null},{"reference":{"otherSlice":4942888801223460576},"usedName":{"constructorName":{"identifier":"PS"},"constructorTypeName":{"identifier":"ByteString"}},"qualification":"S"},{"reference":{"otherSlice":7564022038032245664},"usedName":{"constructorName":{"identifier":"More"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"identifier":"max"}},"qualification":null},{"reference":{"otherSlice":7564022038032245664},"usedName":{"constructorName":{"identifier":"Chunk"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad"},"usedName":{"valueName":{"identifier":"unless"}},"qualification":null},{"reference":{"otherSlice":5578418172209195165},"usedName":{"valueName":{"identifier":"null"}},"qualification":"S"}],"fragment":["toByteStringIOWith ::\n                   Int -> (S.ByteString -> IO ()) -> Builder -> IO ()","toByteStringIOWith !bufSize io builder\n  = do S.mallocByteString bufSize >>=\n         getBuffer (B.runBuilder builder) bufSize\n  where getBuffer writer !size fp\n          = do let !ptr = Unsafe.unsafeForeignPtrToPtr fp\n               (bytes, next) <- writer ptr size\n               case next of\n                   B.Done -> io $! S.PS fp 0 bytes\n                   B.More req writer' -> do io $! S.PS fp 0 bytes\n                                            let !size' = max bufSize req\n                                            S.mallocByteString size' >>= getBuffer writer' size'\n                   B.Chunk bs' writer' -> do if bytes > 0 then\n                                               do io $! S.PS fp 0 bytes\n                                                  unless (S.null bs') (io bs')\n                                                  S.mallocByteString bufSize >>=\n                                                    getBuffer writer' bufSize\n                                               else\n                                               do unless (S.null bs') (io bs')\n                                                  getBuffer writer' size fp"],"instances":[],"language":{"extensions":["BangPatterns","GeneralizedNewtypeDeriving","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}