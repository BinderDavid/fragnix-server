{"sliceID":5024664313298609042,"uses":[{"reference":{"otherSlice":5965689882024213187},"usedName":{"constructorName":{"identifier":"Acquire"},"constructorTypeName":{"identifier":"Acquire"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"valueName":{"identifier":"liftIO"}},"qualification":null},{"reference":{"otherSlice":8172564074456555934},"usedName":{"valueName":{"identifier":"getMaskingState"}},"qualification":"E"},{"reference":{"otherSlice":460497716562189627},"usedName":{"valueName":{"identifier":"mask"}},"qualification":"C"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":3880787913851784560},"usedName":{"constructorName":{"identifier":"Allocated"},"constructorTypeName":{"identifier":"Allocated"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"constructorName":{"identifier":"Unmasked"},"constructorTypeName":{"identifier":"MaskingState"}},"qualification":"E"},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"unsafeUnmask"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"id"}},"qualification":null},{"reference":{"otherSlice":2217614846813828485},"usedName":{"valueName":{"identifier":"onException"}},"qualification":"C"},{"reference":{"otherSlice":41927180059319408},"usedName":{"constructorName":{"identifier":"ReleaseException"},"constructorTypeName":{"identifier":"ReleaseType"}},"qualification":null},{"reference":{"otherSlice":41927180059319408},"usedName":{"constructorName":{"identifier":"ReleaseNormal"},"constructorTypeName":{"identifier":"ReleaseType"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":460497716562189627},"usedName":{"typeName":{"identifier":"MonadMask"}},"qualification":"C"},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"typeName":{"identifier":"MonadIO"}},"qualification":null},{"reference":{"otherSlice":5965689882024213187},"usedName":{"typeName":{"identifier":"Acquire"}},"qualification":null}],"fragment":["withEx ::\n         (C.MonadMask m, MonadIO m) => Acquire a -> (a -> m b) -> m b","withEx (Acquire f) g\n  = do origMS <- liftIO E.getMaskingState\n       C.mask $\n         \\ restore ->\n           do Allocated x free <- liftIO $\n                                    f $\n                                      case origMS of\n                                          E.Unmasked -> unsafeUnmask\n                                          _ -> id\n              res <- restore (g x) `C.onException` liftIO (free ReleaseException)\n              liftIO $ free ReleaseNormal\n              return res"],"instances":[],"language":{"extensions":["RankNTypes","MultiParamTypeClasses","DeriveDataTypeable","FlexibleContexts","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}