{"sliceID":5299639348079163041,"uses":[{"reference":{"otherSlice":7740045047843181165},"usedName":{"valueName":{"identifier":"getFileStatus"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"identifier":"not"}},"qualification":null},{"reference":{"otherSlice":4849985943443332679},"usedName":{"valueName":{"identifier":"isDirectory"}},"qualification":null},{"reference":{"otherSlice":2204412898864778706},"usedName":{"valueName":{"identifier":"fileMode"}},"qualification":null},{"reference":{"otherSlice":1934803912815012913},"usedName":{"valueName":{"identifier":"intersectFileModes"}},"qualification":null},{"reference":{"otherSlice":3699517721252822862},"usedName":{"valueName":{"identifier":"ownerReadMode"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"/="}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"otherSlice":3672792480888377691},"usedName":{"valueName":{"identifier":"epochTimeToHTTPDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":9178064412712073402},"usedName":{"valueName":{"identifier":"modificationTime"}},"qualification":null},{"reference":{"otherSlice":8965489774012109167},"usedName":{"valueName":{"identifier":"formatHTTPDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"otherSlice":3226616342299867364},"usedName":{"valueName":{"identifier":"fileSize"}},"qualification":null},{"reference":{"otherSlice":4083196669851533839},"usedName":{"constructorName":{"identifier":"FileInfo"},"constructorTypeName":{"identifier":"FileInfo"}},"qualification":null},{"reference":{"otherSlice":4083196669851533839},"usedName":{"valueName":{"identifier":"fileInfoName"}},"qualification":null},{"reference":{"otherSlice":4083196669851533839},"usedName":{"valueName":{"identifier":"fileInfoSize"}},"qualification":null},{"reference":{"otherSlice":4083196669851533839},"usedName":{"valueName":{"identifier":"fileInfoTime"}},"qualification":null},{"reference":{"otherSlice":4083196669851533839},"usedName":{"valueName":{"identifier":"fileInfoDate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"throwIO"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Exception"},"usedName":{"valueName":{"identifier":"userError"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"typeName":{"identifier":"FilePath"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":4083196669851533839},"usedName":{"typeName":{"identifier":"FileInfo"}},"qualification":null}],"fragment":["getInfo :: FilePath -> IO FileInfo","getInfo path\n  = do fs <- getFileStatus path\n       let regular = not (isDirectory fs)\n           readable = fileMode fs `intersectFileModes` ownerReadMode /= 0\n       if regular && readable then\n         do let time = epochTimeToHTTPDate $ modificationTime fs\n                date = formatHTTPDate time\n                size = fromIntegral $ fileSize fs\n                info\n                  = FileInfo{fileInfoName = path, fileInfoSize = size,\n                             fileInfoTime = time, fileInfoDate = date}\n            return info\n         else throwIO (userError \"FileInfoCache:getInfo\")"],"instances":[],"language":{"extensions":["RecordWildCards","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}