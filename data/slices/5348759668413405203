{"sliceID":5348759668413405203,"uses":[{"reference":{"otherSlice":3321873544491540098},"usedName":{"constructorName":{"identifier":"Literal"},"constructorTypeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"otherSlice":176597953123978876},"usedName":{"valueName":{"identifier":"path"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":3321873544491540098},"usedName":{"constructorName":{"identifier":"Function"},"constructorTypeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"otherSlice":3321873544491540098},"usedName":{"constructorName":{"identifier":"Capture"},"constructorTypeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"otherSlice":3876047161115307259},"usedName":{"valueName":{"identifier":"split"}},"qualification":"T"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":1897393143230407349},"usedName":{"valueName":{"identifier":"null"}},"qualification":"T"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mconcat"}},"qualification":null},{"reference":{"otherSlice":5554614288449648046},"usedName":{"valueName":{"identifier":"head"}},"qualification":"T"},{"reference":{"otherSlice":384792860316833679},"usedName":{"valueName":{"identifier":"tail"}},"qualification":"T"},{"reference":{"otherSlice":3321873544491540098},"usedName":{"typeName":{"identifier":"RoutePattern"}},"qualification":null},{"reference":{"otherSlice":2150836866812832620},"usedName":{"typeName":{"identifier":"Request"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":6290599581847864836},"usedName":{"typeName":{"identifier":"Param"}},"qualification":null}],"fragment":["matchRoute :: RoutePattern -> Request -> Maybe [Param]","matchRoute (Literal pat) req\n  | pat == path req = Just []\n  | otherwise = Nothing\nmatchRoute (Function fun) req = fun req\nmatchRoute (Capture pat) req\n  = go (T.split (== '/') pat) (T.split (== '/') $ path req) []\n  where go [] [] prs = Just prs\n        go [] r prs\n          | T.null (mconcat r) = Just prs\n          | otherwise = Nothing\n        go p [] prs\n          | T.null (mconcat p) = Just prs\n          | otherwise = Nothing\n        go (p : ps) (r : rs) prs\n          | p == r = go ps rs prs\n          | T.null p = Nothing\n          | T.head p == ':' = go ps rs $ (T.tail p, r) : prs\n          | otherwise = Nothing"],"instances":[],"language":{"extensions":["FlexibleContexts","FlexibleInstances","OverloadedStrings","RankNTypes","ScopedTypeVariables","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}