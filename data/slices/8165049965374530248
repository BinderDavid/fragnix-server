{"sliceID":8165049965374530248,"uses":[{"reference":{"otherSlice":7721714347464982760},"usedName":{"valueName":{"identifier":"sumEncoding"}},"qualification":null},{"reference":{"otherSlice":5829256881764969316},"usedName":{"constructorName":{"identifier":"TwoElemArray"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"otherSlice":2337681378693068080},"usedName":{"constructorName":{"identifier":"Array"},"constructorTypeName":{"identifier":"Value"}},"qualification":null},{"reference":{"otherSlice":7434375718347083459},"usedName":{"valueName":{"identifier":"fromList"}},"qualification":"V"},{"reference":{"otherSlice":3849646064215094801},"usedName":{"valueName":{"identifier":"conStr"}},"qualification":null},{"reference":{"otherSlice":5829256881764969316},"usedName":{"constructorName":{"identifier":"TaggedObject"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"otherSlice":5829256881764969316},"usedName":{"valueName":{"identifier":"tagFieldName"}},"qualification":null},{"reference":{"otherSlice":5829256881764969316},"usedName":{"valueName":{"identifier":"contentsFieldName"}},"qualification":null},{"reference":{"otherSlice":1239263014128492149},"usedName":{"valueName":{"identifier":"pack"}},"qualification":"T"},{"reference":{"otherSlice":5424858156587540989},"usedName":{"valueName":{"operator":".="}},"qualification":null},{"reference":{"otherSlice":7205873948198437081},"usedName":{"valueName":{"identifier":"object"}},"qualification":"A"},{"reference":{"otherSlice":5829256881764969316},"usedName":{"constructorName":{"identifier":"ObjectWithSingleField"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"otherSlice":4040321383975595781},"usedName":{"valueName":{"identifier":"conTxt"}},"qualification":null},{"reference":{"otherSlice":5829256881764969316},"usedName":{"constructorName":{"identifier":"UntaggedValue"},"constructorTypeName":{"identifier":"SumEncoding"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":7721714347464982760},"usedName":{"typeName":{"identifier":"Options"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["sumToValue :: Options -> Bool -> Bool -> Name -> Q Exp -> Q Exp","sumToValue opts multiCons nullary conName exp\n  | multiCons =\n    case sumEncoding opts of\n        TwoElemArray -> [| Array |] `appE`\n                          ([| V.fromList |] `appE` listE [conStr opts conName, exp])\n        TaggedObject{tagFieldName, contentsFieldName} -> let tag\n                                                               = infixApp [| T.pack tagFieldName |]\n                                                                   [| (.=) |]\n                                                                   (conStr opts conName)\n                                                             contents\n                                                               = infixApp\n                                                                   [| T.pack contentsFieldName |]\n                                                                   [| (.=) |]\n                                                                   exp\n                                                           in\n                                                           [| A.object |] `appE`\n                                                             listE\n                                                               (if nullary then [tag] else\n                                                                  [tag, contents])\n        ObjectWithSingleField -> [| A.object |] `appE`\n                                   listE [infixApp (conTxt opts conName) [| (.=) |] exp]\n        UntaggedValue | nullary -> conStr opts conName\n        UntaggedValue -> exp\n  | otherwise = exp"],"instances":[],"language":{"extensions":["BangPatterns","FlexibleInstances","NamedFieldPuns","NoImplicitPrelude","UndecidableInstances","TemplateHaskellQuotes","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards","TemplateHaskell"]}}