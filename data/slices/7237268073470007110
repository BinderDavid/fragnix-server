{"sliceID":7237268073470007110,"uses":[{"reference":{"otherSlice":399320570619546538},"usedName":{"constructorName":{"identifier":"Nil"},"constructorTypeName":{"identifier":"IntPSQ"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":399320570619546538},"usedName":{"constructorName":{"identifier":"Tip"},"constructorTypeName":{"identifier":"IntPSQ"}},"qualification":null},{"reference":{"otherSlice":399320570619546538},"usedName":{"constructorName":{"identifier":"Bin"},"constructorTypeName":{"identifier":"IntPSQ"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"otherSlice":541384921248616526},"usedName":{"constructorName":{"identifier":"L"},"constructorTypeName":{"identifier":"Side"}},"qualification":null},{"reference":{"otherSlice":541384921248616526},"usedName":{"constructorName":{"identifier":"R"},"constructorTypeName":{"identifier":"Side"}},"qualification":null},{"reference":{"otherSlice":1449919909911197069},"usedName":{"typeName":{"identifier":"Mask"}},"qualification":null},{"reference":{"otherSlice":541384921248616526},"usedName":{"typeName":{"identifier":"Side"}},"qualification":null},{"reference":{"otherSlice":399320570619546538},"usedName":{"typeName":{"identifier":"IntPSQ"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"Data.Bits"},"usedName":{"valueName":{"operator":".&."}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"Data.Bits"},"usedName":{"valueName":{"identifier":"xor"}},"qualification":null},{"reference":{"builtinModule":"Data.Functor"},"usedName":{"valueName":{"operator":"<$>"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"<*>"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"otherSlice":1683557414926092802},"usedName":{"valueName":{"identifier":"highestBitMask"}},"qualification":null}],"fragment":["validMask :: IntPSQ p v -> Bool","validMask Nil = True\nvalidMask (Tip _ _ _) = True\nvalidMask (Bin _ _ _ m left right)\n  = maskOk m left right && go m L left && go m R right\n  where go :: Mask -> Side -> IntPSQ p v -> Bool\n        go parentMask side psq\n          = case psq of\n                Nil -> True\n                Tip k _ _ -> checkMaskAndSideMatchKey parentMask side k\n                Bin k _ _ mask l r -> checkMaskAndSideMatchKey parentMask side k &&\n                                        maskOk mask l r && go mask L l && go mask R r\n        checkMaskAndSideMatchKey parentMask side key\n          = case side of\n                L -> parentMask .&. key == 0\n                R -> parentMask .&. key == parentMask\n        \n        maskOk :: Mask -> IntPSQ p v -> IntPSQ p v -> Bool\n        maskOk mask l r\n          = case xor <$> childKey l <*> childKey r of\n                Nothing -> True\n                Just xoredKeys -> fromIntegral mask ==\n                                    highestBitMask (fromIntegral xoredKeys)\n        childKey Nil = Nothing\n        childKey (Tip k _ _) = Just k\n        childKey (Bin k _ _ _ _ _) = Just k"],"instances":[],"language":{"extensions":["BangPatterns","DeriveFoldable","DeriveFunctor","DeriveTraversable","UnboxedTuples","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}