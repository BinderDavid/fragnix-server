{"sliceID":6838780086768721232,"uses":[{"reference":{"otherSlice":2635401880325554829},"usedName":{"typeName":{"identifier":"UTCTime"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":6331514456510255766},"usedName":{"typeName":{"identifier":"TimeZone"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Utils"},"usedName":{"valueName":{"identifier":"with"}},"qualification":null},{"reference":{"builtinModule":"GHC.Ptr"},"usedName":{"valueName":{"identifier":"nullPtr"}},"qualification":null},{"reference":{"otherSlice":6743788070868072242},"usedName":{"valueName":{"identifier":"get_current_timezone_seconds"}},"qualification":null},{"reference":{"otherSlice":78999363555452793},"usedName":{"valueName":{"identifier":"posixToCTime"}},"qualification":null},{"reference":{"otherSlice":2230257857152162290},"usedName":{"valueName":{"identifier":"utcTimeToPOSIXSeconds"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"fail"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Storable"},"usedName":{"valueName":{"identifier":"peek"}},"qualification":null},{"reference":{"builtinModule":"Foreign.C.String"},"usedName":{"valueName":{"identifier":"peekCString"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":6331514456510255766},"usedName":{"constructorName":{"identifier":"TimeZone"},"constructorTypeName":{"identifier":"TimeZone"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"div"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null}],"fragment":["getTimeZone :: UTCTime -> IO TimeZone","getTimeZone time\n  = with 0\n      (\\ pdst ->\n         with nullPtr\n           (\\ pcname ->\n              do secs <- get_current_timezone_seconds\n                           (posixToCTime (utcTimeToPOSIXSeconds time))\n                           pdst\n                           pcname\n                 case secs of\n                     2147483648 -> fail \"localtime_r failed\"\n                     _ -> do dst <- peek pdst\n                             cname <- peek pcname\n                             name <- peekCString cname\n                             return (TimeZone (div (fromIntegral secs) 60) (dst == 1) name)))"],"instances":[],"language":{"extensions":["Rank2Types","DeriveDataTypeable","StandaloneDeriving","ForeignFunctionInterface","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}