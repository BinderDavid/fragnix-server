{"sliceID":8028135390070226233,"uses":[{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"when"}},"qualification":null},{"reference":{"otherSlice":9118708783820425002},"usedName":{"valueName":{"identifier":"verbose"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"valueName":{"identifier":"liftIO"}},"qualification":null},{"reference":{"otherSlice":1611493392424772526},"usedName":{"valueName":{"identifier":"socketDescription"}},"qualification":null},{"reference":{"builtinModule":"System.IO"},"usedName":{"valueName":{"identifier":"putStrLn"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"++"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":9215569047222169733},"usedName":{"valueName":{"identifier":"runSettingsSocket"}},"qualification":null},{"reference":{"otherSlice":9118708783820425002},"usedName":{"valueName":{"identifier":"settings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"=<<"}},"qualification":null},{"reference":{"otherSlice":2668103373466454099},"usedName":{"valueName":{"identifier":"scottyAppT"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Monad"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad.IO.Class"},"usedName":{"typeName":{"identifier":"MonadIO"}},"qualification":null},{"reference":{"otherSlice":9118708783820425002},"usedName":{"typeName":{"identifier":"Options"}},"qualification":null},{"reference":{"otherSlice":2347089666054590766},"usedName":{"typeName":{"identifier":"Socket"}},"qualification":null},{"reference":{"otherSlice":8218805848122191995},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":4728685561892384115},"usedName":{"typeName":{"identifier":"ScottyT"}},"qualification":null}],"fragment":["scottySocketT ::\n                (Monad m, MonadIO n) =>\n                Options ->\n                  Socket -> (m Response -> IO Response) -> ScottyT e m () -> n ()","scottySocketT opts sock runActionToIO s\n  = do when (verbose opts > 0) $\n         do d <- liftIO $ socketDescription sock\n            liftIO $\n              putStrLn $\n                \"Setting phasers to stun... (\" ++ d ++ \") (ctrl-c to quit)\"\n       liftIO . runSettingsSocket (settings opts) sock =<<\n         scottyAppT runActionToIO s"],"instances":[],"language":{"extensions":["OverloadedStrings","RankNTypes","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}