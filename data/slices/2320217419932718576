{"sliceID":2320217419932718576,"uses":[{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mempty"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"mappend"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":1308562469710694256},"usedName":{"valueName":{"identifier":"toLazyByteString"}},"qualification":null},{"reference":{"otherSlice":7429638021109416211},"usedName":{"valueName":{"identifier":"length"}},"qualification":"L"},{"reference":{"builtinModule":"GHC.Prim"},"usedName":{"valueName":{"identifier":"seq"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"writeIORef"}},"qualification":null},{"reference":{"otherSlice":8946881164643755763},"usedName":{"constructorName":{"identifier":"SResponse"},"constructorTypeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":1101192067246769824},"usedName":{"constructorName":{"identifier":"ResponseReceived"},"constructorTypeName":{"identifier":"ResponseReceived"}},"qualification":null},{"reference":{"otherSlice":151727817086787467},"usedName":{"valueName":{"identifier":"responseToStream"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"typeName":{"identifier":"IORef"}},"qualification":null},{"reference":{"otherSlice":8946881164643755763},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":8218805848122191995},"usedName":{"typeName":{"identifier":"Response"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":1101192067246769824},"usedName":{"typeName":{"identifier":"ResponseReceived"}},"qualification":null}],"fragment":["runResponse :: IORef SResponse -> Response -> IO ResponseReceived","runResponse ref res\n  = do refBuilder <- newIORef mempty\n       let add y\n             = atomicModifyIORef refBuilder $ \\ x -> (x `mappend` y, ())\n       withBody $ \\ body -> body add (return ())\n       builder <- readIORef refBuilder\n       let lbs = toLazyByteString builder\n           len = L.length lbs\n       seq len $ writeIORef ref $ SResponse s h $ toLazyByteString builder\n       return ResponseReceived\n  where (s, h, withBody) = responseToStream res"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}