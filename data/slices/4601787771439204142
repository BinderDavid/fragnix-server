{"sliceID":4601787771439204142,"uses":[{"reference":{"otherSlice":6297258265142105704},"usedName":{"valueName":{"identifier":"newTQueueIO"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"newIORef"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":5664972250852548981},"usedName":{"valueName":{"identifier":"initialize"}},"qualification":"T"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":7471038449729235448},"usedName":{"valueName":{"identifier":"settingsTimeout"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"builtinModule":"Data.Functor"},"usedName":{"valueName":{"identifier":"void"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"forkIO"}},"qualification":null},{"reference":{"otherSlice":2931233536321690014},"usedName":{"valueName":{"identifier":"empty"}},"qualification":"Set"},{"reference":{"otherSlice":546518555448962890},"usedName":{"constructorName":{"identifier":"Manager"},"constructorTypeName":{"identifier":"Manager"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"atomically"}},"qualification":null},{"reference":{"otherSlice":8404733269277475534},"usedName":{"valueName":{"identifier":"readTQueue"}},"qualification":null},{"reference":{"otherSlice":1332685761596334265},"usedName":{"constructorName":{"identifier":"Stop"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":2924599673359537740},"usedName":{"valueName":{"identifier":"kill"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"otherSlice":6797834086015507086},"usedName":{"valueName":{"identifier":"killManager"}},"qualification":"T"},{"reference":{"otherSlice":1332685761596334265},"usedName":{"constructorName":{"identifier":"Spawn"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":1332685761596334265},"usedName":{"constructorName":{"identifier":"Add"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":2412452256020162954},"usedName":{"valueName":{"identifier":"add"}},"qualification":null},{"reference":{"otherSlice":1332685761596334265},"usedName":{"constructorName":{"identifier":"Delete"},"constructorTypeName":{"identifier":"Command"}},"qualification":null},{"reference":{"otherSlice":7857849097024621954},"usedName":{"valueName":{"identifier":"del"}},"qualification":null},{"reference":{"builtinModule":"GHC.IORef"},"usedName":{"valueName":{"identifier":"readIORef"}},"qualification":null},{"reference":{"otherSlice":7471038449729235448},"usedName":{"typeName":{"identifier":"Settings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":546518555448962890},"usedName":{"typeName":{"identifier":"Manager"}},"qualification":null}],"fragment":["start :: Settings -> IO Manager","start set\n  = do q <- newTQueueIO\n       ref <- newIORef (\\ _ -> return ())\n       timmgr <- T.initialize $ settingsTimeout set * 1000000\n       void $ forkIO $ go q Set.empty ref timmgr\n       return $ Manager q ref\n  where go q !tset0 ref timmgr\n          = do x <- atomically $ readTQueue q\n               case x of\n                   Stop -> kill tset0 >> T.killManager timmgr\n                   Spawn -> next tset0\n                   Add newtid -> let !tset = add newtid tset0 in go q tset ref timmgr\n                   Delete oldtid -> let !tset = del oldtid tset0 in\n                                      go q tset ref timmgr\n          where next tset\n                  = do action <- readIORef ref\n                       newtid <- forkIO (action timmgr)\n                       let !tset' = add newtid tset\n                       go q tset' ref timmgr"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}