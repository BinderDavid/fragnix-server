{"sliceID":4517673012167254836,"uses":[{"reference":{"otherSlice":1209420743242389773},"usedName":{"valueName":{"identifier":"withFreePort"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":4626736144677812474},"usedName":{"valueName":{"identifier":"mkWaiter"}},"qualification":null},{"reference":{"otherSlice":7471038449729235448},"usedName":{"valueName":{"identifier":"settingsBeforeMainLoop"}},"qualification":null},{"reference":{"otherSlice":8465351735722881111},"usedName":{"valueName":{"identifier":"notify"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":">>"}},"qualification":null},{"reference":{"otherSlice":688753122030383058},"usedName":{"valueName":{"identifier":"race"}},"qualification":null},{"reference":{"otherSlice":9215569047222169733},"usedName":{"valueName":{"identifier":"runSettingsSocket"}},"qualification":null},{"reference":{"otherSlice":8465351735722881111},"usedName":{"valueName":{"identifier":"waitFor"}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"constructorName":{"identifier":"Left"},"constructorTypeName":{"identifier":"Either"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO"},"usedName":{"valueName":{"identifier":"throwIO"}},"qualification":null},{"reference":{"builtinModule":"Data.Either"},"usedName":{"constructorName":{"identifier":"Right"},"constructorTypeName":{"identifier":"Either"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":7471038449729235448},"usedName":{"typeName":{"identifier":"Settings"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":628686228066488211},"usedName":{"typeName":{"identifier":"Application"}},"qualification":null},{"reference":{"otherSlice":77633250252228524},"usedName":{"typeName":{"identifier":"Port"}},"qualification":null}],"fragment":["withApplicationSettings ::\n                        Settings -> IO Application -> (Port -> IO a) -> IO a","withApplicationSettings settings' mkApp action\n  = do app <- mkApp\n       withFreePort $\n         \\ (port, sock) ->\n           do started <- mkWaiter\n              let settings\n                    = settings'{settingsBeforeMainLoop =\n                                  notify started () >> settingsBeforeMainLoop settings'}\n              result <- race (runSettingsSocket settings sock app)\n                          (waitFor started >> action port)\n              case result of\n                  Left () -> throwIO $\n                               ErrorCall \"Unexpected: runSettingsSocket exited\"\n                  Right x -> return x"],"instances":[],"language":{"extensions":["MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}