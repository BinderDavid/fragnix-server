{"sliceID":1061920283477832407,"uses":[{"reference":{"otherSlice":3720735402915720453},"usedName":{"typeName":{"identifier":"JSONClass"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"Data.Traversable"},"usedName":{"valueName":{"identifier":"mapM"}},"qualification":null},{"reference":{"otherSlice":6831538461448984024},"usedName":{"valueName":{"identifier":"expandSyn"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"length"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":4096054026617212887},"usedName":{"valueName":{"identifier":"arityInt"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"drop"}},"qualification":null},{"reference":{"otherSlice":5196877610055752267},"usedName":{"typeName":{"identifier":"StarKindStatus"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"otherSlice":5541453457609625435},"usedName":{"valueName":{"identifier":"canRealizeKindStar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"when"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"||"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"elem"}},"qualification":null},{"reference":{"otherSlice":5196877610055752267},"usedName":{"constructorName":{"identifier":"NotKindStar"},"constructorTypeName":{"identifier":"StarKindStatus"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":1472039162202513454},"usedName":{"valueName":{"identifier":"derivingKindError"}},"qualification":null},{"reference":{"otherSlice":8399923681457635342},"usedName":{"valueName":{"identifier":"catKindVarNames"}},"qualification":null},{"reference":{"otherSlice":8113078754834382883},"usedName":{"valueName":{"identifier":"substNamesWithKindStar"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"splitAt"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"concatMap"}},"qualification":null},{"reference":{"otherSlice":7136998650221838336},"usedName":{"valueName":{"identifier":"tyVarNamesOfType"}},"qualification":null},{"reference":{"builtinModule":"Control.Monad"},"usedName":{"valueName":{"identifier":"unless"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"all"}},"qualification":null},{"reference":{"otherSlice":7996517512476479728},"usedName":{"valueName":{"identifier":"hasKindStar"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"unzip"}},"qualification":null},{"reference":{"otherSlice":7854417378574691160},"usedName":{"valueName":{"identifier":"deriveConstraint"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"concat"}},"qualification":null},{"reference":{"builtinModule":"Data.List"},"usedName":{"valueName":{"identifier":"union"}},"qualification":null},{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"take"}},"qualification":null},{"reference":{"otherSlice":3437942346402144819},"usedName":{"valueName":{"identifier":"unSigT"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"valueName":{"identifier":"catMaybes"}},"qualification":null},{"reference":{"otherSlice":7370108738804099592},"usedName":{"valueName":{"identifier":"jsonClassName"}},"qualification":null},{"reference":{"otherSlice":8367955133841850505},"usedName":{"valueName":{"identifier":"applyTyCon"}},"qualification":null},{"reference":{"builtinModule":"Data.Foldable"},"usedName":{"valueName":{"identifier":"any"}},"qualification":null},{"reference":{"otherSlice":1784784045139927183},"usedName":{"valueName":{"identifier":"predMentionsName"}},"qualification":null},{"reference":{"otherSlice":869926175805276347},"usedName":{"valueName":{"identifier":"datatypeContextError"}},"qualification":null},{"reference":{"otherSlice":5839969391999707466},"usedName":{"valueName":{"identifier":"canEtaReduce"}},"qualification":null},{"reference":{"otherSlice":7382065921918291908},"usedName":{"valueName":{"identifier":"etaReductionError"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null}],"fragment":["buildTypeInstanceFromTys ::\n                         Name -> JSONClass -> Cxt -> [Type] -> Bool -> Q (Cxt, Type)","buildTypeInstanceFromTys tyConName jc dataCxt varTysOrig\n  isDataFamily\n  = do varTysExp <- mapM expandSyn varTysOrig\n       let remainingLength :: Int\n           remainingLength = length varTysOrig - arityInt jc\n           droppedTysExp :: [Type]\n           droppedTysExp = drop remainingLength varTysExp\n           droppedStarKindStati :: [StarKindStatus]\n           droppedStarKindStati = map canRealizeKindStar droppedTysExp\n       when (remainingLength < 0 || elem NotKindStar droppedStarKindStati)\n         $ derivingKindError jc tyConName\n       let droppedKindVarNames :: [Name]\n           droppedKindVarNames = catKindVarNames droppedStarKindStati\n           varTysExpSubst :: [Type]\n           varTysExpSubst\n             = map (substNamesWithKindStar droppedKindVarNames) varTysExp\n           remainingTysExpSubst, droppedTysExpSubst :: [Type]\n           (remainingTysExpSubst, droppedTysExpSubst)\n             = splitAt remainingLength varTysExpSubst\n           droppedTyVarNames :: [Name]\n           droppedTyVarNames = concatMap tyVarNamesOfType droppedTysExpSubst\n       unless (all hasKindStar droppedTysExpSubst) $\n         derivingKindError jc tyConName\n       let preds :: [Maybe Pred]\n           kvNames :: [[Name]]\n           kvNames' :: [Name]\n           (preds, kvNames)\n             = unzip $ map (deriveConstraint jc) remainingTysExpSubst\n           kvNames' = concat kvNames\n           remainingTysExpSubst' :: [Type]\n           remainingTysExpSubst'\n             = map (substNamesWithKindStar kvNames') remainingTysExpSubst\n           remainingTysOrigSubst :: [Type]\n           remainingTysOrigSubst\n             = map\n                 (substNamesWithKindStar (droppedKindVarNames `union` kvNames'))\n                 $ take remainingLength varTysOrig\n           remainingTysOrigSubst' :: [Type]\n           remainingTysOrigSubst'\n             = if isDataFamily then remainingTysOrigSubst else\n                 map unSigT remainingTysOrigSubst\n           instanceCxt :: Cxt\n           instanceCxt = catMaybes preds\n           instanceType :: Type\n           instanceType\n             = AppT (ConT $ jsonClassName jc) $\n                 applyTyCon tyConName remainingTysOrigSubst'\n       when (any (`predMentionsName` droppedTyVarNames) dataCxt) $\n         datatypeContextError tyConName instanceType\n       unless (canEtaReduce remainingTysExpSubst' droppedTysExpSubst) $\n         etaReductionError instanceType\n       return (instanceCxt, instanceType)"],"instances":[],"language":{"extensions":["BangPatterns","FlexibleInstances","NamedFieldPuns","NoImplicitPrelude","UndecidableInstances","TemplateHaskellQuotes","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards","TemplateHaskell"]}}