{"sliceID":3464848212170736466,"uses":[{"reference":{"otherSlice":4888033921282857286},"usedName":{"constructorName":{"identifier":"Logger"},"constructorTypeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"otherSlice":5795733903985395369},"usedName":{"constructorName":{"identifier":"LogStr"},"constructorTypeName":{"identifier":"LogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">"}},"qualification":null},{"reference":{"otherSlice":5033573139318186159},"usedName":{"valueName":{"identifier":"flushLog"}},"qualification":null},{"reference":{"builtinModule":"Foreign.Marshal.Alloc"},"usedName":{"valueName":{"identifier":"allocaBytes"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"Control.Concurrent.MVar"},"usedName":{"valueName":{"identifier":"withMVar"}},"qualification":null},{"reference":{"otherSlice":4122069452250856424},"usedName":{"valueName":{"identifier":"toBufIOWith"}},"qualification":null},{"reference":{"otherSlice":7214446517723940985},"usedName":{"valueName":{"identifier":"write"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"Data.IORef"},"usedName":{"valueName":{"identifier":"atomicModifyIORef'"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":7378093194648876546},"usedName":{"valueName":{"identifier":"writeLogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"Data.Monoid"},"usedName":{"valueName":{"operator":"<>"}},"qualification":null},{"reference":{"otherSlice":4370953465344456963},"usedName":{"typeName":{"identifier":"FD"}},"qualification":null},{"reference":{"otherSlice":4888033921282857286},"usedName":{"typeName":{"identifier":"Logger"}},"qualification":null},{"reference":{"otherSlice":5795733903985395369},"usedName":{"typeName":{"identifier":"LogStr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null}],"fragment":["pushLog :: FD -> Logger -> LogStr -> IO ()","pushLog fd logger@(Logger mbuf size ref)\n  nlogmsg@(LogStr nlen nbuilder)\n  | nlen > size =\n    do flushLog fd logger\n       allocaBytes nlen $\n         \\ buf ->\n           withMVar mbuf $ \\ _ -> toBufIOWith buf nlen (write fd) nbuilder\n  | otherwise =\n    do mmsg <- atomicModifyIORef' ref checkBuf\n       case mmsg of\n           Nothing -> return ()\n           Just msg -> withMVar mbuf $ \\ buf -> writeLogStr fd buf size msg\n  where checkBuf ologmsg@(LogStr olen _)\n          | size < olen + nlen = (nlogmsg, Just ologmsg)\n          | otherwise = (ologmsg <> nlogmsg, Nothing)"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}