{"sliceID":866162753350440556,"uses":[{"reference":{"otherSlice":409732285050159535},"usedName":{"valueName":{"identifier":"newArray"}},"qualification":"IOA"},{"reference":{"otherSlice":9193538520303254692},"usedName":{"valueName":{"identifier":"minTokenIx"}},"qualification":null},{"reference":{"otherSlice":4080549483470999987},"usedName":{"valueName":{"identifier":"maxTokenIx"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":7390130272431652744},"usedName":{"valueName":{"identifier":"unsafeFreeze"}},"qualification":"Unsafe"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"builtinModule":"GHC.IOArray"},"usedName":{"typeName":{"identifier":"IOArray"}},"qualification":"IOA"},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":2816526690544347233},"usedName":{"typeName":{"identifier":"HeaderValue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":1967376015967899813},"usedName":{"typeName":{"identifier":"TokenHeaderList"}},"qualification":null},{"reference":{"otherSlice":211242300878604134},"usedName":{"valueName":{"identifier":"empty"}},"qualification":null},{"reference":{"otherSlice":3945053944125703351},"usedName":{"typeName":{"identifier":"CI"}},"qualification":null},{"reference":{"otherSlice":3506601326909975693},"usedName":{"typeName":{"identifier":"HeaderName"}},"qualification":null},{"reference":{"otherSlice":831882128885765068},"usedName":{"typeName":{"identifier":"Builder"}},"qualification":null},{"reference":{"otherSlice":6929508421568669800},"usedName":{"typeName":{"identifier":"TokenHeader"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":8545298451166551068},"usedName":{"valueName":{"identifier":"run"}},"qualification":null},{"reference":{"otherSlice":3256071029754299372},"usedName":{"valueName":{"identifier":"toToken"}},"qualification":null},{"reference":{"otherSlice":3945053944125703351},"usedName":{"valueName":{"identifier":"foldedCase"}},"qualification":null},{"reference":{"otherSlice":409732285050159535},"usedName":{"valueName":{"identifier":"unsafeWrite"}},"qualification":null},{"reference":{"otherSlice":9105345488677432111},"usedName":{"valueName":{"identifier":"tokenIx"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":4709582743340651841},"usedName":{"valueName":{"operator":"<<"}},"qualification":null},{"reference":{"otherSlice":8600406821186109033},"usedName":{"typeName":{"identifier":"ValueTable"}},"qualification":null}],"fragment":["toHeaderTable ::\n              [(CI HeaderName, HeaderValue)] -> IO (TokenHeaderList, ValueTable)","toHeaderTable kvs\n  = do arr <- IOA.newArray (minTokenIx, maxTokenIx) Nothing\n       !tvs <- conv arr\n       tbl <- Unsafe.unsafeFreeze arr\n       return (tvs, tbl)\n  where conv ::\n             IOA.IOArray Int (Maybe HeaderValue) -> IO TokenHeaderList\n        conv arr = go kvs empty\n          where go ::\n                   [(CI HeaderName, HeaderValue)] ->\n                     Builder TokenHeader -> IO TokenHeaderList\n                go [] builder = return $ run builder\n                go ((k, v) : xs) builder\n                  = do let !t = toToken (foldedCase k)\n                       unsafeWrite arr (tokenIx t) (Just v)\n                       let !tv = (t, v)\n                           !builder' = builder << tv\n                       go xs builder'"],"instances":[],"language":{"extensions":["BangPatterns","RecordWildCards","OverloadedStrings","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}