{"sliceID":4866287886289841992,"uses":[{"reference":{"otherSlice":5540843120797527584},"usedName":{"valueName":{"identifier":"readInteger"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":5888982201187801192},"usedName":{"constructorName":{"identifier":"ByteRangeSuffix"},"constructorTypeName":{"identifier":"ByteRange"}},"qualification":"H"},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"identifier":"negate"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":">="}},"qualification":null},{"reference":{"otherSlice":5888982201187801192},"usedName":{"constructorName":{"identifier":"ByteRangeFromTo"},"constructorTypeName":{"identifier":"ByteRange"}},"qualification":"H"},{"reference":{"otherSlice":5888982201187801192},"usedName":{"constructorName":{"identifier":"ByteRangeFrom"},"constructorTypeName":{"identifier":"ByteRange"}},"qualification":"H"},{"reference":{"otherSlice":5578418172209195165},"usedName":{"valueName":{"identifier":"null"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"otherSlice":404915850270007730},"usedName":{"valueName":{"identifier":"isPrefixOf"}},"qualification":"B"},{"reference":{"otherSlice":1986893899592906745},"usedName":{"valueName":{"identifier":"drop"}},"qualification":"B"},{"reference":{"otherSlice":8819855837653387286},"usedName":{"valueName":{"identifier":"length"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":4942888801223460576},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"typeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":1403983467327225593},"usedName":{"typeName":{"identifier":"ByteRanges"}},"qualification":"H"}],"fragment":["parseByteRanges :: B.ByteString -> Maybe H.ByteRanges","parseByteRanges bs1\n  = do bs2 <- stripPrefix \"bytes=\" bs1\n       (r, bs3) <- range bs2\n       ranges (r :) bs3\n  where range bs2\n          = do (i, bs3) <- B.readInteger bs2\n               if i < 0 then Just (H.ByteRangeSuffix (negate i), bs3) else\n                 do bs4 <- stripPrefix \"-\" bs3\n                    case B.readInteger bs4 of\n                        Just (j, bs5) | j >= i -> Just (H.ByteRangeFromTo i j, bs5)\n                        _ -> Just (H.ByteRangeFrom i, bs4)\n        ranges front bs3\n          | B.null bs3 = Just (front [])\n          | otherwise =\n            do bs4 <- stripPrefix \",\" bs3\n               (r, bs5) <- range bs4\n               ranges (front . (r :)) bs5\n        stripPrefix x y\n          | x `B.isPrefixOf` y = Just (B.drop (B.length x) y)\n          | otherwise = Nothing"],"instances":[],"language":{"extensions":["OverloadedStrings","BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}