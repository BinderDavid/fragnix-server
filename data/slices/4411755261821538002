{"sliceID":4411755261821538002,"uses":[{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"fst"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":3412464986977099381},"usedName":{"valueName":{"identifier":"unfoldrN"}},"qualification":"B"},{"reference":{"otherSlice":8819855837653387286},"usedName":{"valueName":{"identifier":"length"}},"qualification":"B"},{"reference":{"otherSlice":8592546851761716},"usedName":{"valueName":{"identifier":"uncons"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"Data.Maybe"},"usedName":{"valueName":{"identifier":"fromMaybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<="}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"&&"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"builtinModule":"GHC.Word"},"usedName":{"typeName":{"identifier":"Word8"}},"qualification":null},{"reference":{"builtinModule":"Data.Bits"},"usedName":{"valueName":{"identifier":"shiftL"}},"qualification":null},{"reference":{"builtinModule":"Data.Bits"},"usedName":{"valueName":{"operator":".|."}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":4942888801223460576},"usedName":{"typeName":{"identifier":"ByteString"}},"qualification":"B"}],"fragment":["urlDecode :: Bool -> B.ByteString -> B.ByteString","urlDecode replacePlus z = fst $ B.unfoldrN (B.length z) go z\n  where go bs\n          = case B.uncons bs of\n                Nothing -> Nothing\n                Just (43, ws) | replacePlus -> Just (32, ws)\n                Just (37, ws) -> Just $\n                                   fromMaybe (37, ws) $\n                                     do (x, xs) <- B.uncons ws\n                                        x' <- hexVal x\n                                        (y, ys) <- B.uncons xs\n                                        y' <- hexVal y\n                                        Just (combine x' y', ys)\n                Just (w, ws) -> Just (w, ws)\n        hexVal w\n          | 48 <= w && w <= 57 = Just $ w - 48\n          | 65 <= w && w <= 70 = Just $ w - 55\n          | 97 <= w && w <= 102 = Just $ w - 87\n          | otherwise = Nothing\n        \n        combine :: Word8 -> Word8 -> Word8\n        combine a b = shiftL a 4 .|. b"],"instances":[],"language":{"extensions":["OverloadedStrings","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}