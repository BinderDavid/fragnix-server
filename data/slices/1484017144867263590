{"sliceID":1484017144867263590,"uses":[{"reference":{"otherSlice":1868711746240202356},"usedName":{"typeName":{"identifier":"Stream"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Char"}},"qualification":null},{"reference":{"builtinModule":"GHC.Word"},"usedName":{"typeName":{"identifier":"Word8"}},"qualification":null},{"reference":{"otherSlice":1868711746240202356},"usedName":{"constructorName":{"identifier":"Stream"},"constructorTypeName":{"identifier":"Stream"}},"qualification":null},{"reference":{"otherSlice":9032137687827941664},"usedName":{"constructorName":{"identifier":"RS0"},"constructorTypeName":{"identifier":"RS"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"*"}},"qualification":null},{"reference":{"otherSlice":5528339794293630653},"usedName":{"constructorName":{"identifier":"Done"},"constructorTypeName":{"identifier":"Step"}},"qualification":null},{"reference":{"otherSlice":5528339794293630653},"usedName":{"constructorName":{"identifier":"Skip"},"constructorTypeName":{"identifier":"Step"}},"qualification":null},{"reference":{"otherSlice":5528339794293630653},"usedName":{"constructorName":{"identifier":"Yield"},"constructorTypeName":{"identifier":"Step"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"<"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":5928679534711299048},"usedName":{"valueName":{"identifier":"shiftR"}},"qualification":null},{"reference":{"otherSlice":9032137687827941664},"usedName":{"constructorName":{"identifier":"RS1"},"constructorTypeName":{"identifier":"RS"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"otherwise"}},"qualification":null},{"reference":{"otherSlice":9032137687827941664},"usedName":{"constructorName":{"identifier":"RS3"},"constructorTypeName":{"identifier":"RS"}},"qualification":null},{"reference":{"otherSlice":3426116284618420958},"usedName":{"valueName":{"identifier":"ord"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"builtinModule":"Data.Bits"},"usedName":{"valueName":{"operator":".&."}},"qualification":null},{"reference":{"otherSlice":9032137687827941664},"usedName":{"constructorName":{"identifier":"RS2"},"constructorTypeName":{"identifier":"RS"}},"qualification":null}],"fragment":["restreamUtf16BE :: Stream Char -> Stream Word8","restreamUtf16BE (Stream next0 s0 len)\n  = Stream next (RS0 s0) (len * 2)\n  where next (RS0 s)\n          = case next0 s of\n                Done -> Done\n                Skip s' -> Skip (RS0 s')\n                Yield x s' | n < 65536 ->\n                             Yield (fromIntegral $ n `shiftR` 8) $ RS1 s' (fromIntegral n)\n                           | otherwise -> Yield c1 $ RS3 s' c2 c3 c4\n                  where n = ord x\n                        n1 = n - 65536\n                        c1 = fromIntegral (n1 `shiftR` 18 + 216)\n                        c2 = fromIntegral (n1 `shiftR` 10)\n                        n2 = n1 .&. 1023\n                        c3 = fromIntegral (n2 `shiftR` 8 + 220)\n                        c4 = fromIntegral n2\n        next (RS1 s x2) = Yield x2 (RS0 s)\n        next (RS2 s x2 x3) = Yield x2 (RS1 s x3)\n        next (RS3 s x2 x3 x4) = Yield x2 (RS2 s x3 x4)\n        \n        {-# INLINE next #-}"],"instances":[],"language":{"extensions":["BangPatterns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}