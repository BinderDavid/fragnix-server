{"sliceID":3947819997517908848,"uses":[{"reference":{"otherSlice":2347089666054590766},"usedName":{"typeName":{"identifier":"Socket"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Int"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":2347089666054590766},"usedName":{"constructorName":{"identifier":"MkSocket"},"constructorTypeName":{"identifier":"Socket"}},"qualification":null},{"reference":{"builtinModule":"Control.Concurrent.MVar"},"usedName":{"valueName":{"identifier":"modifyMVar_"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"/="}},"qualification":null},{"reference":{"otherSlice":8197619942740010703},"usedName":{"constructorName":{"identifier":"Bound"},"constructorTypeName":{"identifier":"SocketStatus"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Exception"},"usedName":{"valueName":{"identifier":"ioError"}},"qualification":null},{"reference":{"builtinModule":"GHC.IO.Exception"},"usedName":{"valueName":{"identifier":"userError"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"++"}},"qualification":null},{"reference":{"builtinModule":"GHC.Show"},"usedName":{"valueName":{"identifier":"show"}},"qualification":null},{"reference":{"otherSlice":7372583841439616050},"usedName":{"valueName":{"identifier":"throwSocketErrorIfMinus1Retry_"}},"qualification":null},{"reference":{"otherSlice":5247906346774230655},"usedName":{"valueName":{"identifier":"c_listen"}},"qualification":null},{"reference":{"builtinModule":"GHC.Real"},"usedName":{"valueName":{"identifier":"fromIntegral"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":8197619942740010703},"usedName":{"constructorName":{"identifier":"Listening"},"constructorTypeName":{"identifier":"SocketStatus"}},"qualification":null}],"fragment":["listen :: Socket -> Int -> IO ()","listen (MkSocket s _family _stype _protocol socketStatus) backlog\n  = do modifyMVar_ socketStatus $\n         \\ status ->\n           do if status /= Bound then\n                ioError $\n                  userError $\n                    \"Network.Socket.listen: can't listen on socket with status \" ++\n                      show status\n                else\n                do throwSocketErrorIfMinus1Retry_ \"Network.Socket.listen\" $\n                     c_listen s (fromIntegral backlog)\n                   return Listening"],"instances":[],"language":{"extensions":["DeriveDataTypeable","ForeignFunctionInterface","TypeSynonymInstances","ScopedTypeVariables","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}