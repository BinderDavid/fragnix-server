{"sliceID":4877449830135502942,"uses":[{"reference":{"builtinModule":"GHC.List"},"usedName":{"valueName":{"identifier":"filter"}},"qualification":null},{"reference":{"builtinModule":"GHC.Classes"},"usedName":{"valueName":{"operator":"=="}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"."}},"qualification":null},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"fst"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":8946881164643755763},"usedName":{"valueName":{"identifier":"simpleHeaders"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"map"}},"qualification":null},{"reference":{"otherSlice":503392038740243505},"usedName":{"valueName":{"identifier":"parseSetCookie"}},"qualification":"Cookie"},{"reference":{"builtinModule":"Data.Tuple"},"usedName":{"valueName":{"identifier":"snd"}},"qualification":null},{"reference":{"otherSlice":1208687111134656032},"usedName":{"valueName":{"identifier":"modifyClientCookies"}},"qualification":null},{"reference":{"otherSlice":4383616722591945286},"usedName":{"valueName":{"identifier":"union"}},"qualification":"Map"},{"reference":{"otherSlice":4512815971435594603},"usedName":{"valueName":{"identifier":"fromList"}},"qualification":"Map"},{"reference":{"otherSlice":9079646820445488578},"usedName":{"valueName":{"identifier":"setCookieName"}},"qualification":"Cookie"},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":8946881164643755763},"usedName":{"typeName":{"identifier":"SResponse"}},"qualification":null},{"reference":{"otherSlice":6144584388836266359},"usedName":{"typeName":{"identifier":"Session"}},"qualification":null}],"fragment":["extractSetCookieFromSResponse :: SResponse -> Session SResponse","extractSetCookieFromSResponse response\n  = do let setCookieHeaders\n             = filter ((\"Set-Cookie\" ==) . fst) $ simpleHeaders response\n       let newClientCookies\n             = map (Cookie.parseSetCookie . snd) setCookieHeaders\n       modifyClientCookies\n         (Map.union\n            (Map.fromList\n               [(Cookie.setCookieName c, c) | c <- newClientCookies]))\n       return response"],"instances":[],"language":{"extensions":["OverloadedStrings","DeriveDataTypeable","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}