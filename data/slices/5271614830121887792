{"sliceID":5271614830121887792,"uses":[{"reference":{"otherSlice":8433867133710663609},"usedName":{"typeName":{"identifier":"Buffer"}},"qualification":null},{"reference":{"otherSlice":4569852275802132727},"usedName":{"typeName":{"identifier":"BufSize"}},"qualification":null},{"reference":{"otherSlice":6649090572726524833},"usedName":{"typeName":{"identifier":"TBQueue"}},"qualification":null},{"reference":{"otherSlice":8586306918334549122},"usedName":{"typeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"IO"}},"qualification":null},{"reference":{"otherSlice":6254559438599647095},"usedName":{"typeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"typeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"otherSlice":1066210017810895003},"usedName":{"typeName":{"identifier":"BytesFilled"}},"qualification":null},{"reference":{"builtinModule":"GHC.Conc.Sync"},"usedName":{"valueName":{"identifier":"atomically"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"operator":"$"}},"qualification":null},{"reference":{"otherSlice":3966459745625085520},"usedName":{"valueName":{"identifier":"tryReadTBQueue"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Nothing"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"valueName":{"identifier":"return"}},"qualification":null},{"reference":{"otherSlice":6254559438599647095},"usedName":{"constructorName":{"identifier":"LZero"},"constructorTypeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"True"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null},{"reference":{"builtinModule":"GHC.Base"},"usedName":{"constructorName":{"identifier":"Just"},"constructorTypeName":{"identifier":"Maybe"}},"qualification":null},{"reference":{"otherSlice":8586306918334549122},"usedName":{"constructorName":{"identifier":"SBuilder"},"constructorTypeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"otherSlice":2981234607007717022},"usedName":{"valueName":{"identifier":"runBuilder"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"+"}},"qualification":null},{"reference":{"otherSlice":7564022038032245664},"usedName":{"constructorName":{"identifier":"Done"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"builtinModule":"GHC.Ptr"},"usedName":{"valueName":{"identifier":"plusPtr"}},"qualification":null},{"reference":{"builtinModule":"GHC.Num"},"usedName":{"valueName":{"operator":"-"}},"qualification":null},{"reference":{"otherSlice":7564022038032245664},"usedName":{"constructorName":{"identifier":"More"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"otherSlice":6254559438599647095},"usedName":{"constructorName":{"identifier":"LOne"},"constructorTypeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"otherSlice":7564022038032245664},"usedName":{"constructorName":{"identifier":"Chunk"},"constructorTypeName":{"identifier":"Next"}},"qualification":"B"},{"reference":{"otherSlice":6254559438599647095},"usedName":{"constructorName":{"identifier":"LTwo"},"constructorTypeName":{"identifier":"Leftover"}},"qualification":null},{"reference":{"otherSlice":8586306918334549122},"usedName":{"constructorName":{"identifier":"SFlush"},"constructorTypeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"otherSlice":8586306918334549122},"usedName":{"constructorName":{"identifier":"SFinish"},"constructorTypeName":{"identifier":"Sequence"}},"qualification":null},{"reference":{"builtinModule":"GHC.Types"},"usedName":{"constructorName":{"identifier":"False"},"constructorTypeName":{"identifier":"Bool"}},"qualification":null}],"fragment":["runStreamBuilder ::\n                 Buffer ->\n                   BufSize -> TBQueue Sequence -> IO (Leftover, Bool, BytesFilled)","runStreamBuilder buf0 room0 sq = loop buf0 room0 0\n  where loop !buf !room !total\n          = do mbuilder <- atomically $ tryReadTBQueue sq\n               case mbuilder of\n                   Nothing -> return (LZero, True, total)\n                   Just (SBuilder builder) -> do (len, signal) <- B.runBuilder builder\n                                                                    buf\n                                                                    room\n                                                 let !total' = total + len\n                                                 case signal of\n                                                     B.Done -> loop (buf `plusPtr` len) (room - len)\n                                                                 total'\n                                                     B.More _ writer -> return\n                                                                          (LOne writer, True,\n                                                                           total')\n                                                     B.Chunk bs writer -> return\n                                                                            (LTwo bs writer, True,\n                                                                             total')\n                   Just SFlush -> return (LZero, True, total)\n                   Just SFinish -> return (LZero, False, total)"],"instances":[],"language":{"extensions":["OverloadedStrings","BangPatterns","NamedFieldPuns","MultiParamTypeClasses","NondecreasingIndentation","ExplicitForAll","PatternGuards"]}}